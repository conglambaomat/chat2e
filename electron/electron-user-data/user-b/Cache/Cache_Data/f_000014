import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/MessageInput.jsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=3e05e836"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.__vite_plugin_react_preamble_installed__) {
    throw new Error("@vitejs/plugin-react can't detect preamble. Something is wrong. See https://github.com/vitejs/vite-plugin-react/pull/11#discussion_r430879201");
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = (type, id) => {
    RefreshRuntime.register(type, "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx " + id);
  };
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=3e05e836"; const useRef = __vite__cjsImport3_react["useRef"]; const useState = __vite__cjsImport3_react["useState"]; const useCallback = __vite__cjsImport3_react["useCallback"];
import { useChatStore } from "/src/store/useChatStore.js";
import { useAuthStore } from "/src/store/useAuthStore.js";
import { Image, Send, X, Paperclip } from "/node_modules/.vite/deps/lucide-react.js?v=3e05e836";
import toast from "/node_modules/.vite/deps/react-hot-toast.js?v=3e05e836";
import JSEncrypt from "/node_modules/.vite/deps/jsencrypt.js?v=3e05e836";
import { arrayBufferToBase64, base64ToArrayBuffer } from "/src/lib/utils.js";
const MessageInput = () => {
  _s();
  const [text, setText] = useState("");
  const [imagePreview, setImagePreview] = useState(null);
  const [selectedFile, setSelectedFile] = useState(null);
  const fileInputRef = useRef(null);
  const fileAttachmentInputRef = useRef(null);
  const authUser = useAuthStore((state) => state.authUser);
  const selectedUser = useChatStore((state) => state.selectedUser);
  const sendMessage = useChatStore((state) => state.sendMessage);
  const isSendingMessage = useChatStore((state) => state.isSendingMessage);
  const handleImageChange = useCallback((e) => {
    const file = e.target.files[0];
    if (!file) return;
    if (!file.type.startsWith("image/")) {
      toast.error("Please select an image file");
      return;
    }
    const reader = new FileReader();
    reader.onloadend = () => {
      setImagePreview(reader.result);
    };
    reader.readAsDataURL(file);
  }, []);
  const removeImage = useCallback(() => {
    setImagePreview(null);
    if (fileInputRef.current) fileInputRef.current.value = "";
  }, []);
  const handleFileSelect = useCallback((e) => {
    const file = e.target.files[0];
    if (!file) return;
    setSelectedFile(file);
    removeImage();
    setText("");
  }, [removeImage]);
  const removeSelectedFile = useCallback(() => {
    setSelectedFile(null);
    if (fileAttachmentInputRef.current) fileAttachmentInputRef.current.value = "";
  }, []);
  const encryptMessage = async (plainText, recipientPublicKeyPem, senderPublicKeyPem) => {
    console.log("EncryptMessage: Recipient Key PEM:", recipientPublicKeyPem ? recipientPublicKeyPem.substring(0, 50) + "..." : "MISSING/INVALID");
    console.log("EncryptMessage: Sender Key PEM:", senderPublicKeyPem ? senderPublicKeyPem.substring(0, 50) + "..." : "MISSING/INVALID");
    if (!senderPublicKeyPem || typeof senderPublicKeyPem !== "string" || senderPublicKeyPem.length < 100) {
      const errorMsg = "Sender public key is invalid or missing.";
      console.error("EncryptMessage:", errorMsg, senderPublicKeyPem);
      toast.error(errorMsg);
      return null;
    }
    if (!recipientPublicKeyPem || typeof recipientPublicKeyPem !== "string" || recipientPublicKeyPem.length < 100) {
      const errorMsg = "Recipient public key is invalid or missing.";
      console.error("EncryptMessage:", errorMsg, recipientPublicKeyPem);
      toast.error(errorMsg);
      return null;
    }
    try {
      const aesKey = await crypto.subtle.generateKey(
        { name: "AES-GCM", length: 256 },
        true,
        ["encrypt", "decrypt"]
      );
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const exportedAesKeyBuffer = await crypto.subtle.exportKey("raw", aesKey);
      const exportedAesKeyBase64 = arrayBufferToBase64(exportedAesKeyBuffer);
      const encoder = new TextEncoder();
      const encodedPlainText = encoder.encode(plainText);
      const encryptedContentBuffer = await crypto.subtle.encrypt(
        { name: "AES-GCM", iv },
        aesKey,
        encodedPlainText
      );
      const encryptor = new JSEncrypt();
      encryptor.setPublicKey(recipientPublicKeyPem);
      const encryptedAesKeyBase64Recipient = encryptor.encrypt(exportedAesKeyBase64);
      if (!encryptedAesKeyBase64Recipient || typeof encryptedAesKeyBase64Recipient !== "string" || encryptedAesKeyBase64Recipient.length === 0) {
        console.error("EncryptMessage: RSA encryption for RECIPIENT failed. Result:", encryptedAesKeyBase64Recipient);
        throw new Error("RSA encryption of AES key failed for recipient.");
      }
      console.log("EncryptMessage: Recipient encrypted key length:", encryptedAesKeyBase64Recipient.length);
      encryptor.setPublicKey(senderPublicKeyPem);
      const encryptedAesKeyBase64Sender = encryptor.encrypt(exportedAesKeyBase64);
      if (!encryptedAesKeyBase64Sender || typeof encryptedAesKeyBase64Sender !== "string" || encryptedAesKeyBase64Sender.length === 0) {
        console.error("EncryptMessage: RSA encryption for SENDER failed. Result:", encryptedAesKeyBase64Sender);
        console.error("EncryptMessage: Sender public key used:", senderPublicKeyPem ? senderPublicKeyPem.substring(0, 50) + "..." : "MISSING/INVALID");
        throw new Error("RSA encryption of AES key failed for sender. Check sender's public key.");
      }
      console.log("EncryptMessage: Sender encrypted key length:", encryptedAesKeyBase64Sender.length);
      const bundle = {
        encryptedContent: arrayBufferToBase64(encryptedContentBuffer),
        encryptedKey: encryptedAesKeyBase64Recipient,
        encryptedKeySender: encryptedAesKeyBase64Sender,
        iv: arrayBufferToBase64(iv)
      };
      console.log("EncryptMessage: Successfully created bundle:", JSON.stringify(bundle).substring(0, 200) + "...");
      return bundle;
    } catch (error) {
      const errorMessage = `Encryption process failed: ${error.message}`;
      console.error("EncryptMessage Error:", errorMessage, error);
      toast.error(errorMessage);
      return null;
    }
  };
  const encryptBuffer = async (buffer, aesKey) => {
    const iv = crypto.getRandomValues(new Uint8Array(12));
    const encryptedContent = await crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      aesKey,
      buffer
    );
    return { encryptedContent, iv };
  };
  const encryptAesKeyWithRsa = (aesKeyBase64, publicKeyPem) => {
    try {
      const encryptor = new JSEncrypt();
      encryptor.setPublicKey(publicKeyPem);
      const encryptedKey = encryptor.encrypt(aesKeyBase64);
      if (!encryptedKey || typeof encryptedKey !== "string" || encryptedKey.length === 0) {
        throw new Error("RSA encryption returned invalid result.");
      }
      return encryptedKey;
    } catch (error) {
      console.error("Error encrypting AES key with RSA:", error);
      throw error;
    }
  };
  const handleSendFile = useCallback(async () => {
    if (!selectedFile || !selectedUser || !authUser) {
      toast.error("Cannot send file: Missing file, recipient, or sender info.");
      return;
    }
    if (!selectedUser.publicKey || !authUser.publicKey) {
      toast.error("Cannot send file: Missing public keys.");
      return;
    }
    const loadingToastId = toast.loading("Encrypting and uploading file...");
    let fileAesKey = null;
    try {
      fileAesKey = await crypto.subtle.generateKey(
        { name: "AES-GCM", length: 256 },
        true,
        ["encrypt", "decrypt"]
      );
      const exportedAesKeyBuffer = await crypto.subtle.exportKey("raw", fileAesKey);
      const exportedAesKeyBase64 = arrayBufferToBase64(exportedAesKeyBuffer);
      const encryptedAesKeyRecipient = encryptAesKeyWithRsa(exportedAesKeyBase64, selectedUser.publicKey);
      const encryptedAesKeySender = encryptAesKeyWithRsa(exportedAesKeyBase64, authUser.publicKey);
      const fileBuffer = await selectedFile.arrayBuffer();
      const { encryptedContent: encryptedFileBuffer, iv: fileIv } = await encryptBuffer(fileBuffer, fileAesKey);
      const encryptedBytesToSend = new Uint8Array(encryptedFileBuffer);
      console.log(`[handleSendFile] Encrypted Buffer To Send (${encryptedBytesToSend.length} bytes) Start:`, encryptedBytesToSend.slice(0, 16));
      console.log(`[handleSendFile] Encrypted Buffer To Send End:`, encryptedBytesToSend.slice(-16));
      const formData = new FormData();
      formData.append("file", new Blob([encryptedFileBuffer]), selectedFile.name);
      const uploadResponse = await fetch("http://localhost:5001/api/files/upload", {
        method: "POST",
        body: formData,
        credentials: "include"
      });
      if (!uploadResponse.ok) {
        const errorData = await uploadResponse.json();
        throw new Error(`File upload failed: ${errorData.message || uploadResponse.statusText}`);
      }
      const uploadResult = await uploadResponse.json();
      const serverFilename = uploadResult.filename;
      const fileIvBase64 = arrayBufferToBase64(fileIv);
      console.log("[handleSendFile] Storing File IV (Base64):", fileIvBase64);
      const fileMessageData = {
        is_file: true,
        original_file_name: selectedFile.name,
        file_type: selectedFile.type,
        file_size: selectedFile.size,
        file_path: serverFilename,
        file_iv: fileIvBase64,
        file_encrypted_key: encryptedAesKeyRecipient,
        file_encrypted_key_sender: encryptedAesKeySender,
        encryptedContent: null,
        encryptedKey: null,
        encryptedKeySender: null,
        iv: null
      };
      await sendMessage(fileMessageData);
      toast.success("File sent successfully!", { id: loadingToastId });
      removeSelectedFile();
    } catch (error) {
      console.error("Error sending file:", error);
      toast.error(`Failed to send file: ${error.message}`, { id: loadingToastId });
    }
  }, [selectedFile, selectedUser, authUser, sendMessage, removeSelectedFile]);
  const handleSendMessage = useCallback(
    async (e) => {
      e.preventDefault();
      if (selectedFile) {
        await handleSendFile();
        return;
      }
      const messageContent = imagePreview || text.trim();
      if (!messageContent || !selectedUser || !authUser) {
        const missingData = !selectedUser ? "Recipient not selected" : !authUser ? "Sender data not available" : "Message content is empty";
        toast.error(`Cannot send message: ${missingData}.`);
        return;
      }
      if (!selectedUser._id || !authUser._id) {
        toast.error("Cannot send message: User ID missing.");
        return;
      }
      const encryptedBundle = await encryptMessage(
        messageContent,
        selectedUser.publicKey,
        authUser.publicKey
      );
      if (encryptedBundle) {
        try {
          await sendMessage(encryptedBundle);
          setText("");
          removeImage();
        } catch (error) {
          console.error("handleSendMessage: Error returned from store sendMessage:", error);
        }
      }
    },
    [
      imagePreview,
      text,
      selectedUser,
      authUser,
      sendMessage,
      removeImage,
      selectedFile,
      handleSendFile
    ]
  );
  return /* @__PURE__ */ jsxDEV("div", { className: "p-4 w-full", children: [
    selectedFile && !imagePreview && /* @__PURE__ */ jsxDEV("div", { className: "mb-3 flex items-center gap-2 p-2 rounded-lg bg-base-200 border border-zinc-700", children: [
      /* @__PURE__ */ jsxDEV(Paperclip, { className: "size-5 text-zinc-400" }, void 0, false, {
        fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
        lineNumber: 311,
        columnNumber: 21
      }, this),
      /* @__PURE__ */ jsxDEV("span", { className: "text-sm text-zinc-300 truncate flex-1", children: [
        selectedFile.name,
        " (",
        (selectedFile.size / 1024).toFixed(1),
        " KB)"
      ] }, void 0, true, {
        fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
        lineNumber: 312,
        columnNumber: 21
      }, this),
      /* @__PURE__ */ jsxDEV(
        "button",
        {
          onClick: removeSelectedFile,
          className: "w-5 h-5 rounded-full bg-base-300 flex items-center justify-center text-zinc-400 hover:text-red-500",
          type: "button",
          "aria-label": "Remove selected file",
          children: /* @__PURE__ */ jsxDEV(X, { className: "size-3" }, void 0, false, {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 321,
            columnNumber: 25
          }, this)
        },
        void 0,
        false,
        {
          fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
          lineNumber: 315,
          columnNumber: 21
        },
        this
      )
    ] }, void 0, true, {
      fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
      lineNumber: 310,
      columnNumber: 7
    }, this),
    imagePreview && /* @__PURE__ */ jsxDEV("div", { className: "mb-3 flex items-center gap-2", children: /* @__PURE__ */ jsxDEV("div", { className: "relative", children: [
      /* @__PURE__ */ jsxDEV(
        "img",
        {
          src: imagePreview,
          alt: "Preview",
          className: "w-20 h-20 object-cover rounded-lg border border-zinc-700"
        },
        void 0,
        false,
        {
          fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
          lineNumber: 329,
          columnNumber: 25
        },
        this
      ),
      /* @__PURE__ */ jsxDEV(
        "button",
        {
          onClick: removeImage,
          className: "absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full bg-base-300\n              flex items-center justify-center",
          type: "button",
          "aria-label": "Remove image preview",
          children: /* @__PURE__ */ jsxDEV(X, { className: "size-3" }, void 0, false, {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 341,
            columnNumber: 29
          }, this)
        },
        void 0,
        false,
        {
          fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
          lineNumber: 334,
          columnNumber: 25
        },
        this
      )
    ] }, void 0, true, {
      fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
      lineNumber: 328,
      columnNumber: 21
    }, this) }, void 0, false, {
      fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
      lineNumber: 327,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV("form", { onSubmit: handleSendMessage, className: "flex items-center gap-2", children: [
      /* @__PURE__ */ jsxDEV("div", { className: "flex-1 flex gap-2", children: [
        /* @__PURE__ */ jsxDEV(
          "input",
          {
            type: "text",
            className: "w-full input input-bordered rounded-lg input-sm sm:input-md",
            placeholder: "Type an encrypted message...",
            value: text,
            onChange: (e) => setText(e.target.value),
            disabled: !!imagePreview || !!selectedFile || isSendingMessage
          },
          void 0,
          false,
          {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 349,
            columnNumber: 21
          },
          this
        ),
        /* @__PURE__ */ jsxDEV(
          "input",
          {
            type: "file",
            accept: "image/*",
            className: "hidden",
            ref: fileInputRef,
            onChange: handleImageChange,
            disabled: isSendingMessage,
            "aria-label": "Select image"
          },
          void 0,
          false,
          {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 357,
            columnNumber: 21
          },
          this
        ),
        /* @__PURE__ */ jsxDEV(
          "input",
          {
            type: "file",
            className: "hidden",
            ref: fileAttachmentInputRef,
            onChange: handleFileSelect,
            disabled: isSendingMessage,
            "aria-label": "Attach file"
          },
          void 0,
          false,
          {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 366,
            columnNumber: 21
          },
          this
        ),
        /* @__PURE__ */ jsxDEV(
          "button",
          {
            type: "button",
            title: "Select image",
            className: `hidden sm:flex btn btn-circle btn-sm sm:btn-md
                     ${imagePreview ? "text-emerald-500" : "text-zinc-400"} ${isSendingMessage || selectedFile ? "btn-disabled opacity-50" : ""}`,
            onClick: () => fileInputRef.current?.click(),
            disabled: isSendingMessage || !!selectedFile,
            children: /* @__PURE__ */ jsxDEV(Image, { size: 20 }, void 0, false, {
              fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
              lineNumber: 383,
              columnNumber: 25
            }, this)
          },
          void 0,
          false,
          {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 375,
            columnNumber: 21
          },
          this
        ),
        /* @__PURE__ */ jsxDEV(
          "button",
          {
            type: "button",
            title: "Attach file",
            className: `hidden sm:flex btn btn-circle btn-sm sm:btn-md text-zinc-400 ${isSendingMessage || imagePreview ? "btn-disabled opacity-50" : ""}`,
            onClick: () => fileAttachmentInputRef.current?.click(),
            disabled: isSendingMessage || !!imagePreview,
            children: /* @__PURE__ */ jsxDEV(Paperclip, { size: 20 }, void 0, false, {
              fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
              lineNumber: 393,
              columnNumber: 25
            }, this)
          },
          void 0,
          false,
          {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 386,
            columnNumber: 21
          },
          this
        )
      ] }, void 0, true, {
        fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
        lineNumber: 348,
        columnNumber: 17
      }, this),
      /* @__PURE__ */ jsxDEV(
        "button",
        {
          type: "submit",
          title: "Send message",
          className: `btn btn-sm sm:btn-md btn-circle ${isSendingMessage ? "loading btn-disabled" : ""}`,
          disabled: !text.trim() && !imagePreview && !selectedFile || isSendingMessage,
          children: !isSendingMessage && /* @__PURE__ */ jsxDEV(Send, { size: 22 }, void 0, false, {
            fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
            lineNumber: 402,
            columnNumber: 43
          }, this)
        },
        void 0,
        false,
        {
          fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
          lineNumber: 396,
          columnNumber: 17
        },
        this
      )
    ] }, void 0, true, {
      fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
      lineNumber: 347,
      columnNumber: 13
    }, this)
  ] }, void 0, true, {
    fileName: "E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx",
    lineNumber: 308,
    columnNumber: 5
  }, this);
};
_s(MessageInput, "8j72O8BqCozesXSv4VqTVM6lkUY=", false, function() {
  return [useAuthStore, useChatStore, useChatStore, useChatStore];
});
_c = MessageInput;
export default MessageInput;
var _c;
$RefreshReg$(_c, "MessageInput");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("E:/Do_an_Lap_Trinh_mang/NT106.Nhom7/frontend/src/components/MessageInput.jsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6IkFBc1RvQjsyQkF0VHBCO0FBQWlCQSxNQUFVQyxjQUFXLE9BQVEsc0JBQU87QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDckQsU0FBU0Msb0JBQW9CO0FBQzdCLFNBQVNDLG9CQUFvQjtBQUM3QixTQUFTQyxPQUFPQyxNQUFNQyxHQUFHQyxpQkFBaUI7QUFDMUMsT0FBT0MsV0FBVztBQUNsQixPQUFPQyxlQUFlO0FBQ3RCLFNBQVNDLHFCQUFxQkMsMkJBQTJCO0FBRXpELE1BQU1DLGVBQWVBLE1BQU07QUFBQUMsS0FBQTtBQUN2QixRQUFNLENBQUNDLE1BQU1DLE9BQU8sSUFBSWYsU0FBUyxFQUFFO0FBQ25DLFFBQU0sQ0FBQ2dCLGNBQWNDLGVBQWUsSUFBSWpCLFNBQVMsSUFBSTtBQUNyRCxRQUFNLENBQUNrQixjQUFjQyxlQUFlLElBQUluQixTQUFTLElBQUk7QUFDckQsUUFBTW9CLGVBQWVDLE9BQU8sSUFBSTtBQUNoQyxRQUFNQyx5QkFBeUJELE9BQU8sSUFBSTtBQUcxQyxRQUFNRSxXQUFXcEIsYUFBYSxDQUFBcUIsVUFBU0EsTUFBTUQsUUFBUTtBQUdyRCxRQUFNRSxlQUFldkIsYUFBYSxDQUFBc0IsVUFBU0EsTUFBTUMsWUFBWTtBQUM3RCxRQUFNQyxjQUFjeEIsYUFBYSxDQUFBc0IsVUFBU0EsTUFBTUUsV0FBVztBQUMzRCxRQUFNQyxtQkFBbUJ6QixhQUFhLENBQUFzQixVQUFTQSxNQUFNRyxnQkFBZ0I7QUFFckUsUUFBTUMsb0JBQW9CM0IsWUFBWSxDQUFDNEIsTUFBTTtBQUN6QyxVQUFNQyxPQUFPRCxFQUFFRSxPQUFPQyxNQUFNLENBQUM7QUFDN0IsUUFBSSxDQUFDRixLQUFNO0FBQ1gsUUFBSSxDQUFDQSxLQUFLRyxLQUFLQyxXQUFXLFFBQVEsR0FBRztBQUNqQzFCLFlBQU0yQixNQUFNLDZCQUE2QjtBQUN6QztBQUFBLElBQ0o7QUFFQSxVQUFNQyxTQUFTLElBQUlDLFdBQVc7QUFDOUJELFdBQU9FLFlBQVksTUFBTTtBQUNyQnJCLHNCQUFnQm1CLE9BQU9HLE1BQU07QUFBQSxJQUNqQztBQUNBSCxXQUFPSSxjQUFjVixJQUFJO0FBQUEsRUFDN0IsR0FBRyxFQUFFO0FBRUwsUUFBTVcsY0FBY3hDLFlBQVksTUFBTTtBQUNsQ2dCLG9CQUFnQixJQUFJO0FBQ3BCLFFBQUlHLGFBQWFzQixRQUFTdEIsY0FBYXNCLFFBQVFDLFFBQVE7QUFBQSxFQUMzRCxHQUFHLEVBQUU7QUFFTCxRQUFNQyxtQkFBbUIzQyxZQUFZLENBQUM0QixNQUFNO0FBQ3hDLFVBQU1DLE9BQU9ELEVBQUVFLE9BQU9DLE1BQU0sQ0FBQztBQUM3QixRQUFJLENBQUNGLEtBQU07QUFFWFgsb0JBQWdCVyxJQUFJO0FBQ3BCVyxnQkFBWTtBQUNaMUIsWUFBUSxFQUFFO0FBQUEsRUFDZCxHQUFHLENBQUMwQixXQUFXLENBQUM7QUFFaEIsUUFBTUkscUJBQXFCNUMsWUFBWSxNQUFNO0FBQ3pDa0Isb0JBQWdCLElBQUk7QUFDcEIsUUFBSUcsdUJBQXVCb0IsUUFBU3BCLHdCQUF1Qm9CLFFBQVFDLFFBQVE7QUFBQSxFQUMvRSxHQUFHLEVBQUU7QUFHTCxRQUFNRyxpQkFBaUIsT0FBT0MsV0FBV0MsdUJBQXVCQyx1QkFBdUI7QUFFbkZDLFlBQVFDLElBQUksc0NBQXNDSCx3QkFBd0JBLHNCQUFzQkksVUFBVSxHQUFHLEVBQUUsSUFBSSxRQUFRLGlCQUFpQjtBQUM1SUYsWUFBUUMsSUFBSSxtQ0FBbUNGLHFCQUFxQkEsbUJBQW1CRyxVQUFVLEdBQUcsRUFBRSxJQUFJLFFBQVEsaUJBQWlCO0FBR25JLFFBQUksQ0FBQ0gsc0JBQXNCLE9BQU9BLHVCQUF1QixZQUFZQSxtQkFBbUJJLFNBQVMsS0FBSztBQUNsRyxZQUFNQyxXQUFXO0FBQ2pCSixjQUFRZixNQUFNLG1CQUFtQm1CLFVBQVVMLGtCQUFrQjtBQUM3RHpDLFlBQU0yQixNQUFNbUIsUUFBUTtBQUNwQixhQUFPO0FBQUEsSUFDWDtBQUNBLFFBQUksQ0FBQ04seUJBQXlCLE9BQU9BLDBCQUEwQixZQUFZQSxzQkFBc0JLLFNBQVMsS0FBSztBQUMzRyxZQUFNQyxXQUFXO0FBQ2pCSixjQUFRZixNQUFNLG1CQUFtQm1CLFVBQVVOLHFCQUFxQjtBQUNoRXhDLFlBQU0yQixNQUFNbUIsUUFBUTtBQUNwQixhQUFPO0FBQUEsSUFDWDtBQUdBLFFBQUk7QUFFQSxZQUFNQyxTQUFTLE1BQU1DLE9BQU9DLE9BQU9DO0FBQUFBLFFBQy9CLEVBQUVDLE1BQU0sV0FBV04sUUFBUSxJQUFJO0FBQUEsUUFBRztBQUFBLFFBQU0sQ0FBQyxXQUFXLFNBQVM7QUFBQSxNQUNqRTtBQUNBLFlBQU1PLEtBQUtKLE9BQU9LLGdCQUFnQixJQUFJQyxXQUFXLEVBQUUsQ0FBQztBQUNwRCxZQUFNQyx1QkFBdUIsTUFBTVAsT0FBT0MsT0FBT08sVUFBVSxPQUFPVCxNQUFNO0FBQ3hFLFlBQU1VLHVCQUF1QnZELG9CQUFvQnFELG9CQUFvQjtBQUdyRSxZQUFNRyxVQUFVLElBQUlDLFlBQVk7QUFDaEMsWUFBTUMsbUJBQW1CRixRQUFRRyxPQUFPdEIsU0FBUztBQUNqRCxZQUFNdUIseUJBQXlCLE1BQU1kLE9BQU9DLE9BQU9jO0FBQUFBLFFBQy9DLEVBQUVaLE1BQU0sV0FBV0MsR0FBTztBQUFBLFFBQUdMO0FBQUFBLFFBQVFhO0FBQUFBLE1BQ3pDO0FBR0EsWUFBTUksWUFBWSxJQUFJL0QsVUFBVTtBQUNoQytELGdCQUFVQyxhQUFhekIscUJBQXFCO0FBQzVDLFlBQU0wQixpQ0FBaUNGLFVBQVVELFFBQVFOLG9CQUFvQjtBQUM3RSxVQUFJLENBQUNTLGtDQUFrQyxPQUFPQSxtQ0FBbUMsWUFBWUEsK0JBQStCckIsV0FBVyxHQUFHO0FBQ3RJSCxnQkFBUWYsTUFBTSxnRUFBZ0V1Qyw4QkFBOEI7QUFDNUcsY0FBTSxJQUFJQyxNQUFNLGlEQUFpRDtBQUFBLE1BQ3JFO0FBQ0F6QixjQUFRQyxJQUFJLG1EQUFtRHVCLCtCQUErQnJCLE1BQU07QUFHcEdtQixnQkFBVUMsYUFBYXhCLGtCQUFrQjtBQUN6QyxZQUFNMkIsOEJBQThCSixVQUFVRCxRQUFRTixvQkFBb0I7QUFHMUUsVUFBSSxDQUFDVywrQkFBK0IsT0FBT0EsZ0NBQWdDLFlBQVlBLDRCQUE0QnZCLFdBQVcsR0FBRztBQUM3SEgsZ0JBQVFmLE1BQU0sNkRBQTZEeUMsMkJBQTJCO0FBRXRHMUIsZ0JBQVFmLE1BQU0sMkNBQTJDYyxxQkFBcUJBLG1CQUFtQkcsVUFBVSxHQUFHLEVBQUUsSUFBSSxRQUFRLGlCQUFpQjtBQUM3SSxjQUFNLElBQUl1QixNQUFNLHlFQUF5RTtBQUFBLE1BQzdGO0FBQ0F6QixjQUFRQyxJQUFJLGdEQUFnRHlCLDRCQUE0QnZCLE1BQU07QUFJOUYsWUFBTXdCLFNBQVM7QUFBQSxRQUNYQyxrQkFBa0JwRSxvQkFBb0I0RCxzQkFBc0I7QUFBQSxRQUM1RFMsY0FBY0w7QUFBQUEsUUFDZE0sb0JBQW9CSjtBQUFBQSxRQUNwQmhCLElBQUlsRCxvQkFBb0JrRCxFQUFFO0FBQUEsTUFDOUI7QUFFQVYsY0FBUUMsSUFBSSxnREFBZ0Q4QixLQUFLQyxVQUFVTCxNQUFNLEVBQUV6QixVQUFVLEdBQUcsR0FBRyxJQUFJLEtBQUs7QUFDNUcsYUFBT3lCO0FBQUFBLElBRVgsU0FBUzFDLE9BQU87QUFDWixZQUFNZ0QsZUFBZSw4QkFBOEJoRCxNQUFNaUQsT0FBTztBQUNoRWxDLGNBQVFmLE1BQU0seUJBQXlCZ0QsY0FBY2hELEtBQUs7QUFDMUQzQixZQUFNMkIsTUFBTWdELFlBQVk7QUFDeEIsYUFBTztBQUFBLElBQ1g7QUFBQSxFQUNKO0FBR0EsUUFBTUUsZ0JBQWdCLE9BQU9DLFFBQVEvQixXQUFXO0FBQzVDLFVBQU1LLEtBQUtKLE9BQU9LLGdCQUFnQixJQUFJQyxXQUFXLEVBQUUsQ0FBQztBQUNwRCxVQUFNZ0IsbUJBQW1CLE1BQU10QixPQUFPQyxPQUFPYztBQUFBQSxNQUN6QyxFQUFFWixNQUFNLFdBQVdDLEdBQU87QUFBQSxNQUMxQkw7QUFBQUEsTUFDQStCO0FBQUFBLElBQ0o7QUFDQSxXQUFPLEVBQUVSLGtCQUFrQmxCLEdBQUc7QUFBQSxFQUNsQztBQUdBLFFBQU0yQix1QkFBdUJBLENBQUNDLGNBQWNDLGlCQUFpQjtBQUN6RCxRQUFJO0FBQ0EsWUFBTWpCLFlBQVksSUFBSS9ELFVBQVU7QUFDaEMrRCxnQkFBVUMsYUFBYWdCLFlBQVk7QUFDbkMsWUFBTVYsZUFBZVAsVUFBVUQsUUFBUWlCLFlBQVk7QUFDbkQsVUFBSSxDQUFDVCxnQkFBZ0IsT0FBT0EsaUJBQWlCLFlBQVlBLGFBQWExQixXQUFXLEdBQUc7QUFDaEYsY0FBTSxJQUFJc0IsTUFBTSx5Q0FBeUM7QUFBQSxNQUM3RDtBQUNBLGFBQU9JO0FBQUFBLElBQ1gsU0FBUzVDLE9BQU87QUFDWmUsY0FBUWYsTUFBTSxzQ0FBc0NBLEtBQUs7QUFDekQsWUFBTUE7QUFBQUEsSUFDVjtBQUFBLEVBQ0o7QUFHQSxRQUFNdUQsaUJBQWlCekYsWUFBWSxZQUFZO0FBQzNDLFFBQUksQ0FBQ2lCLGdCQUFnQixDQUFDTyxnQkFBZ0IsQ0FBQ0YsVUFBVTtBQUM3Q2YsWUFBTTJCLE1BQU0sNERBQTREO0FBQ3hFO0FBQUEsSUFDSjtBQUNBLFFBQUksQ0FBQ1YsYUFBYWtFLGFBQWEsQ0FBQ3BFLFNBQVNvRSxXQUFXO0FBQ2hEbkYsWUFBTTJCLE1BQU0sd0NBQXdDO0FBQ3BEO0FBQUEsSUFDSjtBQUVBLFVBQU15RCxpQkFBaUJwRixNQUFNcUYsUUFBUSxrQ0FBa0M7QUFDdkUsUUFBSUMsYUFBYTtBQUVqQixRQUFJO0FBRUFBLG1CQUFhLE1BQU10QyxPQUFPQyxPQUFPQztBQUFBQSxRQUM3QixFQUFFQyxNQUFNLFdBQVdOLFFBQVEsSUFBSTtBQUFBLFFBQUc7QUFBQSxRQUFNLENBQUMsV0FBVyxTQUFTO0FBQUEsTUFDakU7QUFDQSxZQUFNVSx1QkFBdUIsTUFBTVAsT0FBT0MsT0FBT08sVUFBVSxPQUFPOEIsVUFBVTtBQUM1RSxZQUFNN0IsdUJBQXVCdkQsb0JBQW9CcUQsb0JBQW9CO0FBR3JFLFlBQU1nQywyQkFBMkJSLHFCQUFxQnRCLHNCQUFzQnhDLGFBQWFrRSxTQUFTO0FBQ2xHLFlBQU1LLHdCQUF3QlQscUJBQXFCdEIsc0JBQXNCMUMsU0FBU29FLFNBQVM7QUFHM0YsWUFBTU0sYUFBYSxNQUFNL0UsYUFBYWdGLFlBQVk7QUFHbEQsWUFBTSxFQUFFcEIsa0JBQWtCcUIscUJBQXFCdkMsSUFBSXdDLE9BQU8sSUFBSSxNQUFNZixjQUFjWSxZQUFZSCxVQUFVO0FBR3hHLFlBQU1PLHVCQUF1QixJQUFJdkMsV0FBV3FDLG1CQUFtQjtBQUMvRGpELGNBQVFDLElBQUksOENBQThDa0QscUJBQXFCaEQsTUFBTSxrQkFBa0JnRCxxQkFBcUJDLE1BQU0sR0FBRyxFQUFFLENBQUM7QUFDeElwRCxjQUFRQyxJQUFJLGtEQUFrRGtELHFCQUFxQkMsTUFBTSxHQUFHLENBQUM7QUFHN0YsWUFBTUMsV0FBVyxJQUFJQyxTQUFTO0FBRTlCRCxlQUFTRSxPQUFPLFFBQVEsSUFBSUMsS0FBSyxDQUFDUCxtQkFBbUIsQ0FBQyxHQUFHakYsYUFBYXlDLElBQUk7QUFHMUUsWUFBTWdELGlCQUFpQixNQUFNQyxNQUFNLDBDQUEwQztBQUFBLFFBQ3pFQyxRQUFRO0FBQUEsUUFDUkMsTUFBTVA7QUFBQUEsUUFDTlEsYUFBYTtBQUFBLE1BQ2pCLENBQUM7QUFFRCxVQUFJLENBQUNKLGVBQWVLLElBQUk7QUFDcEIsY0FBTUMsWUFBWSxNQUFNTixlQUFlTyxLQUFLO0FBQzVDLGNBQU0sSUFBSXZDLE1BQU0sdUJBQXVCc0MsVUFBVTdCLFdBQVd1QixlQUFlUSxVQUFVLEVBQUU7QUFBQSxNQUMzRjtBQUVBLFlBQU1DLGVBQWUsTUFBTVQsZUFBZU8sS0FBSztBQUMvQyxZQUFNRyxpQkFBaUJELGFBQWFFO0FBR3BDLFlBQU1DLGVBQWU3RyxvQkFBb0IwRixNQUFNO0FBQy9DbEQsY0FBUUMsSUFBSSw4Q0FBOENvRSxZQUFZO0FBR3RFLFlBQU1DLGtCQUFrQjtBQUFBLFFBQ3BCQyxTQUFTO0FBQUEsUUFDVEMsb0JBQW9CeEcsYUFBYXlDO0FBQUFBLFFBQ2pDZ0UsV0FBV3pHLGFBQWFlO0FBQUFBLFFBQ3hCMkYsV0FBVzFHLGFBQWEyRztBQUFBQSxRQUN4QkMsV0FBV1Q7QUFBQUEsUUFFWFUsU0FBU1I7QUFBQUEsUUFDVFMsb0JBQW9CakM7QUFBQUEsUUFDcEJrQywyQkFBMkJqQztBQUFBQSxRQUczQmxCLGtCQUFrQjtBQUFBLFFBQ2xCQyxjQUFjO0FBQUEsUUFDZEMsb0JBQW9CO0FBQUEsUUFDcEJwQixJQUFJO0FBQUEsTUFDUjtBQUlBLFlBQU1sQyxZQUFZOEYsZUFBZTtBQUNqQ2hILFlBQU0wSCxRQUFRLDJCQUEyQixFQUFFQyxJQUFJdkMsZUFBZSxDQUFDO0FBQy9EL0MseUJBQW1CO0FBQUEsSUFFdkIsU0FBU1YsT0FBTztBQUNaZSxjQUFRZixNQUFNLHVCQUF1QkEsS0FBSztBQUMxQzNCLFlBQU0yQixNQUFNLHdCQUF3QkEsTUFBTWlELE9BQU8sSUFBSSxFQUFFK0MsSUFBSXZDLGVBQWUsQ0FBQztBQUFBLElBRS9FO0FBQUEsRUFDSixHQUFHLENBQUMxRSxjQUFjTyxjQUFjRixVQUFVRyxhQUFhbUIsa0JBQWtCLENBQUM7QUFFMUUsUUFBTXVGLG9CQUFvQm5JO0FBQUFBLElBQVksT0FBTzRCLE1BQU07QUFDL0NBLFFBQUV3RyxlQUFlO0FBR2pCLFVBQUluSCxjQUFjO0FBQ2QsY0FBTXdFLGVBQWU7QUFDckI7QUFBQSxNQUNKO0FBR0EsWUFBTTRDLGlCQUFpQnRILGdCQUFnQkYsS0FBS3lILEtBQUs7QUFFakQsVUFBSSxDQUFDRCxrQkFBa0IsQ0FBQzdHLGdCQUFnQixDQUFDRixVQUFVO0FBRS9DLGNBQU1pSCxjQUFjLENBQUMvRyxlQUFlLDJCQUEyQixDQUFDRixXQUFXLDhCQUE4QjtBQUN6R2YsY0FBTTJCLE1BQU0sd0JBQXdCcUcsV0FBVyxHQUFHO0FBQ2xEO0FBQUEsTUFDSjtBQUdBLFVBQUksQ0FBQy9HLGFBQWFnSCxPQUFPLENBQUNsSCxTQUFTa0gsS0FBSztBQUNwQ2pJLGNBQU0yQixNQUFNLHVDQUF1QztBQUNuRDtBQUFBLE1BQ0o7QUFFQSxZQUFNdUcsa0JBQWtCLE1BQU01RjtBQUFBQSxRQUMxQndGO0FBQUFBLFFBQ0E3RyxhQUFha0U7QUFBQUEsUUFDYnBFLFNBQVNvRTtBQUFBQSxNQUNiO0FBR0EsVUFBSStDLGlCQUFpQjtBQUNqQixZQUFJO0FBRUEsZ0JBQU1oSCxZQUFZZ0gsZUFBZTtBQUNqQzNILGtCQUFRLEVBQUU7QUFDVjBCLHNCQUFZO0FBQUEsUUFDaEIsU0FBU04sT0FBTztBQUVaZSxrQkFBUWYsTUFBTSw2REFBNkRBLEtBQUs7QUFBQSxRQUVwRjtBQUFBLE1BQ0o7QUFBQSxJQUNKO0FBQUEsSUFBRztBQUFBLE1BQ0NuQjtBQUFBQSxNQUFjRjtBQUFBQSxNQUFNVztBQUFBQSxNQUFjRjtBQUFBQSxNQUFVRztBQUFBQSxNQUFhZTtBQUFBQSxNQUN6RHZCO0FBQUFBLE1BQWN3RTtBQUFBQSxJQUFjO0FBQUEsRUFDL0I7QUFFRCxTQUNJLHVCQUFDLFNBQUksV0FBVSxjQUNWeEU7QUFBQUEsb0JBQWdCLENBQUNGLGdCQUNkLHVCQUFDLFNBQUksV0FBVSxrRkFDWDtBQUFBLDZCQUFDLGFBQVUsV0FBVSwwQkFBckI7QUFBQTtBQUFBO0FBQUE7QUFBQSxhQUEyQztBQUFBLE1BQzNDLHVCQUFDLFVBQUssV0FBVSx5Q0FDWEU7QUFBQUEscUJBQWF5QztBQUFBQSxRQUFLO0FBQUEsU0FBSXpDLGFBQWEyRyxPQUFPLE1BQU1jLFFBQVEsQ0FBQztBQUFBLFFBQUU7QUFBQSxXQURoRTtBQUFBO0FBQUE7QUFBQTtBQUFBLGFBRUE7QUFBQSxNQUNBO0FBQUEsUUFBQztBQUFBO0FBQUEsVUFDRyxTQUFTOUY7QUFBQUEsVUFDVCxXQUFVO0FBQUEsVUFDVixNQUFLO0FBQUEsVUFDTCxjQUFXO0FBQUEsVUFFWCxpQ0FBQyxLQUFFLFdBQVUsWUFBYjtBQUFBO0FBQUE7QUFBQTtBQUFBLGlCQUFxQjtBQUFBO0FBQUEsUUFOekI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BT0E7QUFBQSxTQVpKO0FBQUE7QUFBQTtBQUFBO0FBQUEsV0FhQTtBQUFBLElBR0g3QixnQkFDRyx1QkFBQyxTQUFJLFdBQVUsZ0NBQ1gsaUNBQUMsU0FBSSxXQUFVLFlBQ1g7QUFBQTtBQUFBLFFBQUM7QUFBQTtBQUFBLFVBQ0csS0FBS0E7QUFBQUEsVUFDTCxLQUFJO0FBQUEsVUFDSixXQUFVO0FBQUE7QUFBQSxRQUhkO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxNQUd3RTtBQUFBLE1BRXhFO0FBQUEsUUFBQztBQUFBO0FBQUEsVUFDRyxTQUFTeUI7QUFBQUEsVUFDVCxXQUFVO0FBQUEsVUFFVixNQUFLO0FBQUEsVUFDTCxjQUFXO0FBQUEsVUFFWCxpQ0FBQyxLQUFFLFdBQVUsWUFBYjtBQUFBO0FBQUE7QUFBQTtBQUFBLGlCQUFxQjtBQUFBO0FBQUEsUUFQekI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BUUE7QUFBQSxTQWRKO0FBQUE7QUFBQTtBQUFBO0FBQUEsV0FlQSxLQWhCSjtBQUFBO0FBQUE7QUFBQTtBQUFBLFdBaUJBO0FBQUEsSUFHSix1QkFBQyxVQUFLLFVBQVUyRixtQkFBbUIsV0FBVSwyQkFDekM7QUFBQSw2QkFBQyxTQUFJLFdBQVUscUJBQ1g7QUFBQTtBQUFBLFVBQUM7QUFBQTtBQUFBLFlBQ0csTUFBSztBQUFBLFlBQ0wsV0FBVTtBQUFBLFlBQ1YsYUFBWTtBQUFBLFlBQ1osT0FBT3RIO0FBQUFBLFlBQ1AsVUFBVSxDQUFDZSxNQUFNZCxRQUFRYyxFQUFFRSxPQUFPWSxLQUFLO0FBQUEsWUFDdkMsVUFBVSxDQUFDLENBQUMzQixnQkFBZ0IsQ0FBQyxDQUFDRSxnQkFBZ0JTO0FBQUFBO0FBQUFBLFVBTmxEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxRQU1tRTtBQUFBLFFBRW5FO0FBQUEsVUFBQztBQUFBO0FBQUEsWUFDRyxNQUFLO0FBQUEsWUFDTCxRQUFPO0FBQUEsWUFDUCxXQUFVO0FBQUEsWUFDVixLQUFLUDtBQUFBQSxZQUNMLFVBQVVRO0FBQUFBLFlBQ1YsVUFBVUQ7QUFBQUEsWUFDVixjQUFXO0FBQUE7QUFBQSxVQVBmO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxRQU82QjtBQUFBLFFBRTdCO0FBQUEsVUFBQztBQUFBO0FBQUEsWUFDRyxNQUFLO0FBQUEsWUFDTCxXQUFVO0FBQUEsWUFDVixLQUFLTDtBQUFBQSxZQUNMLFVBQVVzQjtBQUFBQSxZQUNWLFVBQVVqQjtBQUFBQSxZQUNWLGNBQVc7QUFBQTtBQUFBLFVBTmY7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFFBTTRCO0FBQUEsUUFHNUI7QUFBQSxVQUFDO0FBQUE7QUFBQSxZQUNHLE1BQUs7QUFBQSxZQUNMLE9BQU07QUFBQSxZQUNOLFdBQVc7QUFBQSx1QkFDWlgsZUFBZSxxQkFBcUIsZUFBZSxJQUFJVyxvQkFBb0JULGVBQWUsNEJBQTRCLEVBQUU7QUFBQSxZQUN2SCxTQUFTLE1BQU1FLGFBQWFzQixTQUFTa0csTUFBTTtBQUFBLFlBQzNDLFVBQVVqSCxvQkFBb0IsQ0FBQyxDQUFDVDtBQUFBQSxZQUVoQyxpQ0FBQyxTQUFNLE1BQU0sTUFBYjtBQUFBO0FBQUE7QUFBQTtBQUFBLG1CQUFnQjtBQUFBO0FBQUEsVUFScEI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLFFBU0E7QUFBQSxRQUVBO0FBQUEsVUFBQztBQUFBO0FBQUEsWUFDRyxNQUFLO0FBQUEsWUFDTCxPQUFNO0FBQUEsWUFDTixXQUFXLGdFQUFnRVMsb0JBQW9CWCxlQUFlLDRCQUE0QixFQUFFO0FBQUEsWUFDNUksU0FBUyxNQUFNTSx1QkFBdUJvQixTQUFTa0csTUFBTTtBQUFBLFlBQ3JELFVBQVVqSCxvQkFBb0IsQ0FBQyxDQUFDWDtBQUFBQSxZQUVoQyxpQ0FBQyxhQUFVLE1BQU0sTUFBakI7QUFBQTtBQUFBO0FBQUE7QUFBQSxtQkFBb0I7QUFBQTtBQUFBLFVBUHhCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxRQVFBO0FBQUEsV0E5Q0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxhQStDQTtBQUFBLE1BQ0E7QUFBQSxRQUFDO0FBQUE7QUFBQSxVQUNHLE1BQUs7QUFBQSxVQUNMLE9BQU07QUFBQSxVQUNOLFdBQVcsbUNBQW1DVyxtQkFBbUIseUJBQXlCLEVBQUU7QUFBQSxVQUM1RixVQUFXLENBQUNiLEtBQUt5SCxLQUFLLEtBQUssQ0FBQ3ZILGdCQUFnQixDQUFDRSxnQkFBaUJTO0FBQUFBLFVBRTdELFdBQUNBLG9CQUFvQix1QkFBQyxRQUFLLE1BQU0sTUFBWjtBQUFBO0FBQUE7QUFBQTtBQUFBLGlCQUFlO0FBQUE7QUFBQSxRQU56QztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsTUFPQTtBQUFBLFNBeERKO0FBQUE7QUFBQTtBQUFBO0FBQUEsV0F5REE7QUFBQSxPQWhHSjtBQUFBO0FBQUE7QUFBQTtBQUFBLFNBaUdBO0FBRVI7QUFBRWQsR0E5WUlELGNBQVk7QUFBQSxVQVFHVCxjQUdJRCxjQUNEQSxjQUNLQSxZQUFZO0FBQUE7QUFBQTJJLEtBYm5Dakk7QUErWU4sZUFBZUE7QUFBYSxJQUFBaUk7QUFBQUMsYUFBQUQsSUFBQSIsIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlQ2FsbGJhY2siLCJ1c2VDaGF0U3RvcmUiLCJ1c2VBdXRoU3RvcmUiLCJJbWFnZSIsIlNlbmQiLCJYIiwiUGFwZXJjbGlwIiwidG9hc3QiLCJKU0VuY3J5cHQiLCJhcnJheUJ1ZmZlclRvQmFzZTY0IiwiYmFzZTY0VG9BcnJheUJ1ZmZlciIsIk1lc3NhZ2VJbnB1dCIsIl9zIiwidGV4dCIsInNldFRleHQiLCJpbWFnZVByZXZpZXciLCJzZXRJbWFnZVByZXZpZXciLCJzZWxlY3RlZEZpbGUiLCJzZXRTZWxlY3RlZEZpbGUiLCJmaWxlSW5wdXRSZWYiLCJ1c2VSZWYiLCJmaWxlQXR0YWNobWVudElucHV0UmVmIiwiYXV0aFVzZXIiLCJzdGF0ZSIsInNlbGVjdGVkVXNlciIsInNlbmRNZXNzYWdlIiwiaXNTZW5kaW5nTWVzc2FnZSIsImhhbmRsZUltYWdlQ2hhbmdlIiwiZSIsImZpbGUiLCJ0YXJnZXQiLCJmaWxlcyIsInR5cGUiLCJzdGFydHNXaXRoIiwiZXJyb3IiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkZW5kIiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsInJlbW92ZUltYWdlIiwiY3VycmVudCIsInZhbHVlIiwiaGFuZGxlRmlsZVNlbGVjdCIsInJlbW92ZVNlbGVjdGVkRmlsZSIsImVuY3J5cHRNZXNzYWdlIiwicGxhaW5UZXh0IiwicmVjaXBpZW50UHVibGljS2V5UGVtIiwic2VuZGVyUHVibGljS2V5UGVtIiwiY29uc29sZSIsImxvZyIsInN1YnN0cmluZyIsImxlbmd0aCIsImVycm9yTXNnIiwiYWVzS2V5IiwiY3J5cHRvIiwic3VidGxlIiwiZ2VuZXJhdGVLZXkiLCJuYW1lIiwiaXYiLCJnZXRSYW5kb21WYWx1ZXMiLCJVaW50OEFycmF5IiwiZXhwb3J0ZWRBZXNLZXlCdWZmZXIiLCJleHBvcnRLZXkiLCJleHBvcnRlZEFlc0tleUJhc2U2NCIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsImVuY29kZWRQbGFpblRleHQiLCJlbmNvZGUiLCJlbmNyeXB0ZWRDb250ZW50QnVmZmVyIiwiZW5jcnlwdCIsImVuY3J5cHRvciIsInNldFB1YmxpY0tleSIsImVuY3J5cHRlZEFlc0tleUJhc2U2NFJlY2lwaWVudCIsIkVycm9yIiwiZW5jcnlwdGVkQWVzS2V5QmFzZTY0U2VuZGVyIiwiYnVuZGxlIiwiZW5jcnlwdGVkQ29udGVudCIsImVuY3J5cHRlZEtleSIsImVuY3J5cHRlZEtleVNlbmRlciIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwiZW5jcnlwdEJ1ZmZlciIsImJ1ZmZlciIsImVuY3J5cHRBZXNLZXlXaXRoUnNhIiwiYWVzS2V5QmFzZTY0IiwicHVibGljS2V5UGVtIiwiaGFuZGxlU2VuZEZpbGUiLCJwdWJsaWNLZXkiLCJsb2FkaW5nVG9hc3RJZCIsImxvYWRpbmciLCJmaWxlQWVzS2V5IiwiZW5jcnlwdGVkQWVzS2V5UmVjaXBpZW50IiwiZW5jcnlwdGVkQWVzS2V5U2VuZGVyIiwiZmlsZUJ1ZmZlciIsImFycmF5QnVmZmVyIiwiZW5jcnlwdGVkRmlsZUJ1ZmZlciIsImZpbGVJdiIsImVuY3J5cHRlZEJ5dGVzVG9TZW5kIiwic2xpY2UiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiQmxvYiIsInVwbG9hZFJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiY3JlZGVudGlhbHMiLCJvayIsImVycm9yRGF0YSIsImpzb24iLCJzdGF0dXNUZXh0IiwidXBsb2FkUmVzdWx0Iiwic2VydmVyRmlsZW5hbWUiLCJmaWxlbmFtZSIsImZpbGVJdkJhc2U2NCIsImZpbGVNZXNzYWdlRGF0YSIsImlzX2ZpbGUiLCJvcmlnaW5hbF9maWxlX25hbWUiLCJmaWxlX3R5cGUiLCJmaWxlX3NpemUiLCJzaXplIiwiZmlsZV9wYXRoIiwiZmlsZV9pdiIsImZpbGVfZW5jcnlwdGVkX2tleSIsImZpbGVfZW5jcnlwdGVkX2tleV9zZW5kZXIiLCJzdWNjZXNzIiwiaWQiLCJoYW5kbGVTZW5kTWVzc2FnZSIsInByZXZlbnREZWZhdWx0IiwibWVzc2FnZUNvbnRlbnQiLCJ0cmltIiwibWlzc2luZ0RhdGEiLCJfaWQiLCJlbmNyeXB0ZWRCdW5kbGUiLCJ0b0ZpeGVkIiwiY2xpY2siLCJfYyIsIiRSZWZyZXNoUmVnJCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJNZXNzYWdlSW5wdXQuanN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVJlZiwgdXNlU3RhdGUsIHVzZUNhbGxiYWNrIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VDaGF0U3RvcmUgfSBmcm9tIFwiLi4vc3RvcmUvdXNlQ2hhdFN0b3JlXCI7XG5pbXBvcnQgeyB1c2VBdXRoU3RvcmUgfSBmcm9tIFwiLi4vc3RvcmUvdXNlQXV0aFN0b3JlXCI7XG5pbXBvcnQgeyBJbWFnZSwgU2VuZCwgWCwgUGFwZXJjbGlwIH0gZnJvbSBcImx1Y2lkZS1yZWFjdFwiO1xuaW1wb3J0IHRvYXN0IGZyb20gXCJyZWFjdC1ob3QtdG9hc3RcIjtcbmltcG9ydCBKU0VuY3J5cHQgZnJvbSBcImpzZW5jcnlwdFwiO1xuaW1wb3J0IHsgYXJyYXlCdWZmZXJUb0Jhc2U2NCwgYmFzZTY0VG9BcnJheUJ1ZmZlciB9IGZyb20gXCIuLi9saWIvdXRpbHNcIjtcblxuY29uc3QgTWVzc2FnZUlucHV0ID0gKCkgPT4ge1xuICAgIGNvbnN0IFt0ZXh0LCBzZXRUZXh0XSA9IHVzZVN0YXRlKFwiXCIpO1xuICAgIGNvbnN0IFtpbWFnZVByZXZpZXcsIHNldEltYWdlUHJldmlld10gPSB1c2VTdGF0ZShudWxsKTtcbiAgICBjb25zdCBbc2VsZWN0ZWRGaWxlLCBzZXRTZWxlY3RlZEZpbGVdID0gdXNlU3RhdGUobnVsbCk7XG4gICAgY29uc3QgZmlsZUlucHV0UmVmID0gdXNlUmVmKG51bGwpO1xuICAgIGNvbnN0IGZpbGVBdHRhY2htZW50SW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7XG5cblxuICAgIGNvbnN0IGF1dGhVc2VyID0gdXNlQXV0aFN0b3JlKHN0YXRlID0+IHN0YXRlLmF1dGhVc2VyKTtcblxuXG4gICAgY29uc3Qgc2VsZWN0ZWRVc2VyID0gdXNlQ2hhdFN0b3JlKHN0YXRlID0+IHN0YXRlLnNlbGVjdGVkVXNlcik7XG4gICAgY29uc3Qgc2VuZE1lc3NhZ2UgPSB1c2VDaGF0U3RvcmUoc3RhdGUgPT4gc3RhdGUuc2VuZE1lc3NhZ2UpO1xuICAgIGNvbnN0IGlzU2VuZGluZ01lc3NhZ2UgPSB1c2VDaGF0U3RvcmUoc3RhdGUgPT4gc3RhdGUuaXNTZW5kaW5nTWVzc2FnZSk7XG5cbiAgICBjb25zdCBoYW5kbGVJbWFnZUNoYW5nZSA9IHVzZUNhbGxiYWNrKChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm47XG4gICAgICAgIGlmICghZmlsZS50eXBlLnN0YXJ0c1dpdGgoXCJpbWFnZS9cIikpIHtcbiAgICAgICAgICAgIHRvYXN0LmVycm9yKFwiUGxlYXNlIHNlbGVjdCBhbiBpbWFnZSBmaWxlXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9ICgpID0+IHtcbiAgICAgICAgICAgIHNldEltYWdlUHJldmlldyhyZWFkZXIucmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XG4gICAgfSwgW10pO1xuXG4gICAgY29uc3QgcmVtb3ZlSW1hZ2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIHNldEltYWdlUHJldmlldyhudWxsKTtcbiAgICAgICAgaWYgKGZpbGVJbnB1dFJlZi5jdXJyZW50KSBmaWxlSW5wdXRSZWYuY3VycmVudC52YWx1ZSA9IFwiXCI7XG4gICAgfSwgW10pO1xuXG4gICAgY29uc3QgaGFuZGxlRmlsZVNlbGVjdCA9IHVzZUNhbGxiYWNrKChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTtcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm47XG5cbiAgICAgICAgc2V0U2VsZWN0ZWRGaWxlKGZpbGUpO1xuICAgICAgICByZW1vdmVJbWFnZSgpO1xuICAgICAgICBzZXRUZXh0KFwiXCIpO1xuICAgIH0sIFtyZW1vdmVJbWFnZV0pO1xuXG4gICAgY29uc3QgcmVtb3ZlU2VsZWN0ZWRGaWxlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBzZXRTZWxlY3RlZEZpbGUobnVsbCk7XG4gICAgICAgIGlmIChmaWxlQXR0YWNobWVudElucHV0UmVmLmN1cnJlbnQpIGZpbGVBdHRhY2htZW50SW5wdXRSZWYuY3VycmVudC52YWx1ZSA9IFwiXCI7XG4gICAgfSwgW10pO1xuXG5cbiAgICBjb25zdCBlbmNyeXB0TWVzc2FnZSA9IGFzeW5jIChwbGFpblRleHQsIHJlY2lwaWVudFB1YmxpY0tleVBlbSwgc2VuZGVyUHVibGljS2V5UGVtKSA9PiB7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJFbmNyeXB0TWVzc2FnZTogUmVjaXBpZW50IEtleSBQRU06XCIsIHJlY2lwaWVudFB1YmxpY0tleVBlbSA/IHJlY2lwaWVudFB1YmxpY0tleVBlbS5zdWJzdHJpbmcoMCwgNTApICsgXCIuLi5cIiA6IFwiTUlTU0lORy9JTlZBTElEXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkVuY3J5cHRNZXNzYWdlOiBTZW5kZXIgS2V5IFBFTTpcIiwgc2VuZGVyUHVibGljS2V5UGVtID8gc2VuZGVyUHVibGljS2V5UGVtLnN1YnN0cmluZygwLCA1MCkgKyBcIi4uLlwiIDogXCJNSVNTSU5HL0lOVkFMSURcIik7XG5cblxuICAgICAgICBpZiAoIXNlbmRlclB1YmxpY0tleVBlbSB8fCB0eXBlb2Ygc2VuZGVyUHVibGljS2V5UGVtICE9PSAnc3RyaW5nJyB8fCBzZW5kZXJQdWJsaWNLZXlQZW0ubGVuZ3RoIDwgMTAwKSB7IC8vIEJhc2ljIGNoZWNrXG4gICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IFwiU2VuZGVyIHB1YmxpYyBrZXkgaXMgaW52YWxpZCBvciBtaXNzaW5nLlwiO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVuY3J5cHRNZXNzYWdlOlwiLCBlcnJvck1zZywgc2VuZGVyUHVibGljS2V5UGVtKTtcbiAgICAgICAgICAgIHRvYXN0LmVycm9yKGVycm9yTXNnKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVjaXBpZW50UHVibGljS2V5UGVtIHx8IHR5cGVvZiByZWNpcGllbnRQdWJsaWNLZXlQZW0gIT09ICdzdHJpbmcnIHx8IHJlY2lwaWVudFB1YmxpY0tleVBlbS5sZW5ndGggPCAxMDApIHsgLy8gQmFzaWMgY2hlY2sgZm9yIHJlY2lwaWVudCB0b29cbiAgICAgICAgICAgIGNvbnN0IGVycm9yTXNnID0gXCJSZWNpcGllbnQgcHVibGljIGtleSBpcyBpbnZhbGlkIG9yIG1pc3NpbmcuXCI7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRW5jcnlwdE1lc3NhZ2U6XCIsIGVycm9yTXNnLCByZWNpcGllbnRQdWJsaWNLZXlQZW0pO1xuICAgICAgICAgICAgdG9hc3QuZXJyb3IoZXJyb3JNc2cpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIGNvbnN0IGFlc0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZ2VuZXJhdGVLZXkoXG4gICAgICAgICAgICAgICAgeyBuYW1lOiBcIkFFUy1HQ01cIiwgbGVuZ3RoOiAyNTYgfSwgdHJ1ZSwgW1wiZW5jcnlwdFwiLCBcImRlY3J5cHRcIl1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBpdiA9IGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTIpKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cG9ydGVkQWVzS2V5QnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5leHBvcnRLZXkoXCJyYXdcIiwgYWVzS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IGV4cG9ydGVkQWVzS2V5QmFzZTY0ID0gYXJyYXlCdWZmZXJUb0Jhc2U2NChleHBvcnRlZEFlc0tleUJ1ZmZlcik7XG5cblxuICAgICAgICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgICAgICAgICAgY29uc3QgZW5jb2RlZFBsYWluVGV4dCA9IGVuY29kZXIuZW5jb2RlKHBsYWluVGV4dCk7XG4gICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWRDb250ZW50QnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5lbmNyeXB0KFxuICAgICAgICAgICAgICAgIHsgbmFtZTogXCJBRVMtR0NNXCIsIGl2OiBpdiB9LCBhZXNLZXksIGVuY29kZWRQbGFpblRleHRcbiAgICAgICAgICAgICk7XG5cblxuICAgICAgICAgICAgY29uc3QgZW5jcnlwdG9yID0gbmV3IEpTRW5jcnlwdCgpO1xuICAgICAgICAgICAgZW5jcnlwdG9yLnNldFB1YmxpY0tleShyZWNpcGllbnRQdWJsaWNLZXlQZW0pO1xuICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkQWVzS2V5QmFzZTY0UmVjaXBpZW50ID0gZW5jcnlwdG9yLmVuY3J5cHQoZXhwb3J0ZWRBZXNLZXlCYXNlNjQpO1xuICAgICAgICAgICAgaWYgKCFlbmNyeXB0ZWRBZXNLZXlCYXNlNjRSZWNpcGllbnQgfHwgdHlwZW9mIGVuY3J5cHRlZEFlc0tleUJhc2U2NFJlY2lwaWVudCAhPT0gJ3N0cmluZycgfHwgZW5jcnlwdGVkQWVzS2V5QmFzZTY0UmVjaXBpZW50Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFbmNyeXB0TWVzc2FnZTogUlNBIGVuY3J5cHRpb24gZm9yIFJFQ0lQSUVOVCBmYWlsZWQuIFJlc3VsdDpcIiwgZW5jcnlwdGVkQWVzS2V5QmFzZTY0UmVjaXBpZW50KTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSU0EgZW5jcnlwdGlvbiBvZiBBRVMga2V5IGZhaWxlZCBmb3IgcmVjaXBpZW50LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRW5jcnlwdE1lc3NhZ2U6IFJlY2lwaWVudCBlbmNyeXB0ZWQga2V5IGxlbmd0aDpcIiwgZW5jcnlwdGVkQWVzS2V5QmFzZTY0UmVjaXBpZW50Lmxlbmd0aCk7XG5cblxuICAgICAgICAgICAgZW5jcnlwdG9yLnNldFB1YmxpY0tleShzZW5kZXJQdWJsaWNLZXlQZW0pO1xuICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkQWVzS2V5QmFzZTY0U2VuZGVyID0gZW5jcnlwdG9yLmVuY3J5cHQoZXhwb3J0ZWRBZXNLZXlCYXNlNjQpO1xuXG5cbiAgICAgICAgICAgIGlmICghZW5jcnlwdGVkQWVzS2V5QmFzZTY0U2VuZGVyIHx8IHR5cGVvZiBlbmNyeXB0ZWRBZXNLZXlCYXNlNjRTZW5kZXIgIT09ICdzdHJpbmcnIHx8IGVuY3J5cHRlZEFlc0tleUJhc2U2NFNlbmRlci5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRW5jcnlwdE1lc3NhZ2U6IFJTQSBlbmNyeXB0aW9uIGZvciBTRU5ERVIgZmFpbGVkLiBSZXN1bHQ6XCIsIGVuY3J5cHRlZEFlc0tleUJhc2U2NFNlbmRlcik7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRW5jcnlwdE1lc3NhZ2U6IFNlbmRlciBwdWJsaWMga2V5IHVzZWQ6XCIsIHNlbmRlclB1YmxpY0tleVBlbSA/IHNlbmRlclB1YmxpY0tleVBlbS5zdWJzdHJpbmcoMCwgNTApICsgXCIuLi5cIiA6IFwiTUlTU0lORy9JTlZBTElEXCIpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJTQSBlbmNyeXB0aW9uIG9mIEFFUyBrZXkgZmFpbGVkIGZvciBzZW5kZXIuIENoZWNrIHNlbmRlcidzIHB1YmxpYyBrZXkuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFbmNyeXB0TWVzc2FnZTogU2VuZGVyIGVuY3J5cHRlZCBrZXkgbGVuZ3RoOlwiLCBlbmNyeXB0ZWRBZXNLZXlCYXNlNjRTZW5kZXIubGVuZ3RoKTtcblxuXG5cbiAgICAgICAgICAgIGNvbnN0IGJ1bmRsZSA9IHtcbiAgICAgICAgICAgICAgICBlbmNyeXB0ZWRDb250ZW50OiBhcnJheUJ1ZmZlclRvQmFzZTY0KGVuY3J5cHRlZENvbnRlbnRCdWZmZXIpLFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleTogZW5jcnlwdGVkQWVzS2V5QmFzZTY0UmVjaXBpZW50LFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleVNlbmRlcjogZW5jcnlwdGVkQWVzS2V5QmFzZTY0U2VuZGVyLFxuICAgICAgICAgICAgICAgIGl2OiBhcnJheUJ1ZmZlclRvQmFzZTY0KGl2KSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRW5jcnlwdE1lc3NhZ2U6IFN1Y2Nlc3NmdWxseSBjcmVhdGVkIGJ1bmRsZTpcIiwgSlNPTi5zdHJpbmdpZnkoYnVuZGxlKS5zdWJzdHJpbmcoMCwgMjAwKSArIFwiLi4uXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGJ1bmRsZTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYEVuY3J5cHRpb24gcHJvY2VzcyBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVuY3J5cHRNZXNzYWdlIEVycm9yOlwiLCBlcnJvck1lc3NhZ2UsIGVycm9yKTtcbiAgICAgICAgICAgIHRvYXN0LmVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG5cblxuICAgIGNvbnN0IGVuY3J5cHRCdWZmZXIgPSBhc3luYyAoYnVmZmVyLCBhZXNLZXkpID0+IHtcbiAgICAgICAgY29uc3QgaXYgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDEyKSk7XG4gICAgICAgIGNvbnN0IGVuY3J5cHRlZENvbnRlbnQgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmVuY3J5cHQoXG4gICAgICAgICAgICB7IG5hbWU6IFwiQUVTLUdDTVwiLCBpdjogaXYgfSxcbiAgICAgICAgICAgIGFlc0tleSxcbiAgICAgICAgICAgIGJ1ZmZlclxuICAgICAgICApO1xuICAgICAgICByZXR1cm4geyBlbmNyeXB0ZWRDb250ZW50LCBpdiB9O1xuICAgIH07XG5cblxuICAgIGNvbnN0IGVuY3J5cHRBZXNLZXlXaXRoUnNhID0gKGFlc0tleUJhc2U2NCwgcHVibGljS2V5UGVtKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlbmNyeXB0b3IgPSBuZXcgSlNFbmNyeXB0KCk7XG4gICAgICAgICAgICBlbmNyeXB0b3Iuc2V0UHVibGljS2V5KHB1YmxpY0tleVBlbSk7XG4gICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWRLZXkgPSBlbmNyeXB0b3IuZW5jcnlwdChhZXNLZXlCYXNlNjQpO1xuICAgICAgICAgICAgaWYgKCFlbmNyeXB0ZWRLZXkgfHwgdHlwZW9mIGVuY3J5cHRlZEtleSAhPT0gJ3N0cmluZycgfHwgZW5jcnlwdGVkS2V5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJTQSBlbmNyeXB0aW9uIHJldHVybmVkIGludmFsaWQgcmVzdWx0LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlbmNyeXB0ZWRLZXk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZW5jcnlwdGluZyBBRVMga2V5IHdpdGggUlNBOlwiLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH07XG5cblxuICAgIGNvbnN0IGhhbmRsZVNlbmRGaWxlID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoIXNlbGVjdGVkRmlsZSB8fCAhc2VsZWN0ZWRVc2VyIHx8ICFhdXRoVXNlcikge1xuICAgICAgICAgICAgdG9hc3QuZXJyb3IoXCJDYW5ub3Qgc2VuZCBmaWxlOiBNaXNzaW5nIGZpbGUsIHJlY2lwaWVudCwgb3Igc2VuZGVyIGluZm8uXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZWN0ZWRVc2VyLnB1YmxpY0tleSB8fCAhYXV0aFVzZXIucHVibGljS2V5KSB7XG4gICAgICAgICAgICB0b2FzdC5lcnJvcihcIkNhbm5vdCBzZW5kIGZpbGU6IE1pc3NpbmcgcHVibGljIGtleXMuXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbG9hZGluZ1RvYXN0SWQgPSB0b2FzdC5sb2FkaW5nKFwiRW5jcnlwdGluZyBhbmQgdXBsb2FkaW5nIGZpbGUuLi5cIik7XG4gICAgICAgIGxldCBmaWxlQWVzS2V5ID0gbnVsbDtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICBmaWxlQWVzS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5nZW5lcmF0ZUtleShcbiAgICAgICAgICAgICAgICB7IG5hbWU6IFwiQUVTLUdDTVwiLCBsZW5ndGg6IDI1NiB9LCB0cnVlLCBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiXVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cG9ydGVkQWVzS2V5QnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5leHBvcnRLZXkoXCJyYXdcIiwgZmlsZUFlc0tleSk7XG4gICAgICAgICAgICBjb25zdCBleHBvcnRlZEFlc0tleUJhc2U2NCA9IGFycmF5QnVmZmVyVG9CYXNlNjQoZXhwb3J0ZWRBZXNLZXlCdWZmZXIpO1xuXG5cbiAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZEFlc0tleVJlY2lwaWVudCA9IGVuY3J5cHRBZXNLZXlXaXRoUnNhKGV4cG9ydGVkQWVzS2V5QmFzZTY0LCBzZWxlY3RlZFVzZXIucHVibGljS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IGVuY3J5cHRlZEFlc0tleVNlbmRlciA9IGVuY3J5cHRBZXNLZXlXaXRoUnNhKGV4cG9ydGVkQWVzS2V5QmFzZTY0LCBhdXRoVXNlci5wdWJsaWNLZXkpO1xuXG5cbiAgICAgICAgICAgIGNvbnN0IGZpbGVCdWZmZXIgPSBhd2FpdCBzZWxlY3RlZEZpbGUuYXJyYXlCdWZmZXIoKTtcblxuXG4gICAgICAgICAgICBjb25zdCB7IGVuY3J5cHRlZENvbnRlbnQ6IGVuY3J5cHRlZEZpbGVCdWZmZXIsIGl2OiBmaWxlSXYgfSA9IGF3YWl0IGVuY3J5cHRCdWZmZXIoZmlsZUJ1ZmZlciwgZmlsZUFlc0tleSk7XG5cblxuICAgICAgICAgICAgY29uc3QgZW5jcnlwdGVkQnl0ZXNUb1NlbmQgPSBuZXcgVWludDhBcnJheShlbmNyeXB0ZWRGaWxlQnVmZmVyKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbaGFuZGxlU2VuZEZpbGVdIEVuY3J5cHRlZCBCdWZmZXIgVG8gU2VuZCAoJHtlbmNyeXB0ZWRCeXRlc1RvU2VuZC5sZW5ndGh9IGJ5dGVzKSBTdGFydDpgLCBlbmNyeXB0ZWRCeXRlc1RvU2VuZC5zbGljZSgwLCAxNikpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFtoYW5kbGVTZW5kRmlsZV0gRW5jcnlwdGVkIEJ1ZmZlciBUbyBTZW5kIEVuZDpgLCBlbmNyeXB0ZWRCeXRlc1RvU2VuZC5zbGljZSgtMTYpKTtcblxuXG4gICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuXG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBuZXcgQmxvYihbZW5jcnlwdGVkRmlsZUJ1ZmZlcl0pLCBzZWxlY3RlZEZpbGUubmFtZSk7IC8vIEtlZXAgb3JpZ2luYWwgbmFtZSBmb3IgcG90ZW50aWFsIHNlcnZlci1zaWRlIHVzZSwgdGhvdWdoIGJhY2tlbmQgdXNlcyBVVUlEXG5cblxuICAgICAgICAgICAgY29uc3QgdXBsb2FkUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cDovL2xvY2FsaG9zdDo1MDAxL2FwaS9maWxlcy91cGxvYWQnLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6ICdpbmNsdWRlJyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIXVwbG9hZFJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgdXBsb2FkUmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlsZSB1cGxvYWQgZmFpbGVkOiAke2Vycm9yRGF0YS5tZXNzYWdlIHx8IHVwbG9hZFJlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHVwbG9hZFJlc3VsdCA9IGF3YWl0IHVwbG9hZFJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHNlcnZlckZpbGVuYW1lID0gdXBsb2FkUmVzdWx0LmZpbGVuYW1lO1xuXG5cbiAgICAgICAgICAgIGNvbnN0IGZpbGVJdkJhc2U2NCA9IGFycmF5QnVmZmVyVG9CYXNlNjQoZmlsZUl2KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiW2hhbmRsZVNlbmRGaWxlXSBTdG9yaW5nIEZpbGUgSVYgKEJhc2U2NCk6XCIsIGZpbGVJdkJhc2U2NCk7IC8vIExvZyB0aGUgSVYgYmVpbmcgc3RvcmVkXG5cblxuICAgICAgICAgICAgY29uc3QgZmlsZU1lc3NhZ2VEYXRhID0ge1xuICAgICAgICAgICAgICAgIGlzX2ZpbGU6IHRydWUsXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxfZmlsZV9uYW1lOiBzZWxlY3RlZEZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICBmaWxlX3R5cGU6IHNlbGVjdGVkRmlsZS50eXBlLFxuICAgICAgICAgICAgICAgIGZpbGVfc2l6ZTogc2VsZWN0ZWRGaWxlLnNpemUsXG4gICAgICAgICAgICAgICAgZmlsZV9wYXRoOiBzZXJ2ZXJGaWxlbmFtZSxcblxuICAgICAgICAgICAgICAgIGZpbGVfaXY6IGZpbGVJdkJhc2U2NCxcbiAgICAgICAgICAgICAgICBmaWxlX2VuY3J5cHRlZF9rZXk6IGVuY3J5cHRlZEFlc0tleVJlY2lwaWVudCxcbiAgICAgICAgICAgICAgICBmaWxlX2VuY3J5cHRlZF9rZXlfc2VuZGVyOiBlbmNyeXB0ZWRBZXNLZXlTZW5kZXIsXG5cblxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZENvbnRlbnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgZW5jcnlwdGVkS2V5OiBudWxsLFxuICAgICAgICAgICAgICAgIGVuY3J5cHRlZEtleVNlbmRlcjogbnVsbCxcbiAgICAgICAgICAgICAgICBpdjogbnVsbFxuICAgICAgICAgICAgfTtcblxuXG5cbiAgICAgICAgICAgIGF3YWl0IHNlbmRNZXNzYWdlKGZpbGVNZXNzYWdlRGF0YSk7XG4gICAgICAgICAgICB0b2FzdC5zdWNjZXNzKFwiRmlsZSBzZW50IHN1Y2Nlc3NmdWxseSFcIiwgeyBpZDogbG9hZGluZ1RvYXN0SWQgfSk7XG4gICAgICAgICAgICByZW1vdmVTZWxlY3RlZEZpbGUoKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNlbmRpbmcgZmlsZTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgdG9hc3QuZXJyb3IoYEZhaWxlZCB0byBzZW5kIGZpbGU6ICR7ZXJyb3IubWVzc2FnZX1gLCB7IGlkOiBsb2FkaW5nVG9hc3RJZCB9KTtcblxuICAgICAgICB9XG4gICAgfSwgW3NlbGVjdGVkRmlsZSwgc2VsZWN0ZWRVc2VyLCBhdXRoVXNlciwgc2VuZE1lc3NhZ2UsIHJlbW92ZVNlbGVjdGVkRmlsZV0pO1xuXG4gICAgY29uc3QgaGFuZGxlU2VuZE1lc3NhZ2UgPSB1c2VDYWxsYmFjayhhc3luYyAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cblxuICAgICAgICBpZiAoc2VsZWN0ZWRGaWxlKSB7XG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVTZW5kRmlsZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cblxuICAgICAgICBjb25zdCBtZXNzYWdlQ29udGVudCA9IGltYWdlUHJldmlldyB8fCB0ZXh0LnRyaW0oKTtcblxuICAgICAgICBpZiAoIW1lc3NhZ2VDb250ZW50IHx8ICFzZWxlY3RlZFVzZXIgfHwgIWF1dGhVc2VyKSB7XG5cbiAgICAgICAgICAgIGNvbnN0IG1pc3NpbmdEYXRhID0gIXNlbGVjdGVkVXNlciA/IFwiUmVjaXBpZW50IG5vdCBzZWxlY3RlZFwiIDogIWF1dGhVc2VyID8gXCJTZW5kZXIgZGF0YSBub3QgYXZhaWxhYmxlXCIgOiBcIk1lc3NhZ2UgY29udGVudCBpcyBlbXB0eVwiO1xuICAgICAgICAgICAgdG9hc3QuZXJyb3IoYENhbm5vdCBzZW5kIG1lc3NhZ2U6ICR7bWlzc2luZ0RhdGF9LmApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cblxuICAgICAgICBpZiAoIXNlbGVjdGVkVXNlci5faWQgfHwgIWF1dGhVc2VyLl9pZCkge1xuICAgICAgICAgICAgdG9hc3QuZXJyb3IoXCJDYW5ub3Qgc2VuZCBtZXNzYWdlOiBVc2VyIElEIG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZW5jcnlwdGVkQnVuZGxlID0gYXdhaXQgZW5jcnlwdE1lc3NhZ2UoXG4gICAgICAgICAgICBtZXNzYWdlQ29udGVudCxcbiAgICAgICAgICAgIHNlbGVjdGVkVXNlci5wdWJsaWNLZXksXG4gICAgICAgICAgICBhdXRoVXNlci5wdWJsaWNLZXlcbiAgICAgICAgKTtcblxuXG4gICAgICAgIGlmIChlbmNyeXB0ZWRCdW5kbGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgICAgICBhd2FpdCBzZW5kTWVzc2FnZShlbmNyeXB0ZWRCdW5kbGUpO1xuICAgICAgICAgICAgICAgIHNldFRleHQoXCJcIik7XG4gICAgICAgICAgICAgICAgcmVtb3ZlSW1hZ2UoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiaGFuZGxlU2VuZE1lc3NhZ2U6IEVycm9yIHJldHVybmVkIGZyb20gc3RvcmUgc2VuZE1lc3NhZ2U6XCIsIGVycm9yKTtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgW1xuICAgICAgICBpbWFnZVByZXZpZXcsIHRleHQsIHNlbGVjdGVkVXNlciwgYXV0aFVzZXIsIHNlbmRNZXNzYWdlLCByZW1vdmVJbWFnZSxcbiAgICAgICAgc2VsZWN0ZWRGaWxlLCBoYW5kbGVTZW5kRmlsZVxuICAgIF0pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgdy1mdWxsXCI+XG4gICAgICAgICAgICB7c2VsZWN0ZWRGaWxlICYmICFpbWFnZVByZXZpZXcgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWItMyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwLTIgcm91bmRlZC1sZyBiZy1iYXNlLTIwMCBib3JkZXIgYm9yZGVyLXppbmMtNzAwXCI+XG4gICAgICAgICAgICAgICAgICAgIDxQYXBlcmNsaXAgY2xhc3NOYW1lPVwic2l6ZS01IHRleHQtemluYy00MDBcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtemluYy0zMDAgdHJ1bmNhdGUgZmxleC0xXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7c2VsZWN0ZWRGaWxlLm5hbWV9ICh7KHNlbGVjdGVkRmlsZS5zaXplIC8gMTAyNCkudG9GaXhlZCgxKX0gS0IpXG4gICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17cmVtb3ZlU2VsZWN0ZWRGaWxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy01IGgtNSByb3VuZGVkLWZ1bGwgYmctYmFzZS0zMDAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC16aW5jLTQwMCBob3Zlcjp0ZXh0LXJlZC01MDBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiUmVtb3ZlIHNlbGVjdGVkIGZpbGVcIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8WCBjbGFzc05hbWU9XCJzaXplLTNcIiAvPlxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIHtpbWFnZVByZXZpZXcgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWItMyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjPXtpbWFnZVByZXZpZXd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PVwiUHJldmlld1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0yMCBoLTIwIG9iamVjdC1jb3ZlciByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItemluYy03MDBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtyZW1vdmVJbWFnZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhYnNvbHV0ZSAtdG9wLTEuNSAtcmlnaHQtMS41IHctNSBoLTUgcm91bmRlZC1mdWxsIGJnLWJhc2UtMzAwXG4gICAgICAgICAgICAgIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiUmVtb3ZlIGltYWdlIHByZXZpZXdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxYIGNsYXNzTmFtZT1cInNpemUtM1wiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17aGFuZGxlU2VuZE1lc3NhZ2V9IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgZmxleCBnYXAtMlwiPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBpbnB1dCBpbnB1dC1ib3JkZXJlZCByb3VuZGVkLWxnIGlucHV0LXNtIHNtOmlucHV0LW1kXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVHlwZSBhbiBlbmNyeXB0ZWQgbWVzc2FnZS4uLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0VGV4dChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ISFpbWFnZVByZXZpZXcgfHwgISFzZWxlY3RlZEZpbGUgfHwgaXNTZW5kaW5nTWVzc2FnZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiZmlsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQ9XCJpbWFnZS8qXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhpZGRlblwiXG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9e2ZpbGVJbnB1dFJlZn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVJbWFnZUNoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtpc1NlbmRpbmdNZXNzYWdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIlNlbGVjdCBpbWFnZVwiXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImZpbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaGlkZGVuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17ZmlsZUF0dGFjaG1lbnRJbnB1dFJlZn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVGaWxlU2VsZWN0fVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzU2VuZGluZ01lc3NhZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiQXR0YWNoIGZpbGVcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJTZWxlY3QgaW1hZ2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgaGlkZGVuIHNtOmZsZXggYnRuIGJ0bi1jaXJjbGUgYnRuLXNtIHNtOmJ0bi1tZFxuICAgICAgICAgICAgICAgICAgICAgJHtpbWFnZVByZXZpZXcgPyBcInRleHQtZW1lcmFsZC01MDBcIiA6IFwidGV4dC16aW5jLTQwMFwifSAke2lzU2VuZGluZ01lc3NhZ2UgfHwgc2VsZWN0ZWRGaWxlID8gJ2J0bi1kaXNhYmxlZCBvcGFjaXR5LTUwJyA6ICcnfWB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBmaWxlSW5wdXRSZWYuY3VycmVudD8uY2xpY2soKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtpc1NlbmRpbmdNZXNzYWdlIHx8ICEhc2VsZWN0ZWRGaWxlfVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8SW1hZ2Ugc2l6ZT17MjB9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9XCJBdHRhY2ggZmlsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BoaWRkZW4gc206ZmxleCBidG4gYnRuLWNpcmNsZSBidG4tc20gc206YnRuLW1kIHRleHQtemluYy00MDAgJHtpc1NlbmRpbmdNZXNzYWdlIHx8IGltYWdlUHJldmlldyA/ICdidG4tZGlzYWJsZWQgb3BhY2l0eS01MCcgOiAnJ31gfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gZmlsZUF0dGFjaG1lbnRJbnB1dFJlZi5jdXJyZW50Py5jbGljaygpfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzU2VuZGluZ01lc3NhZ2UgfHwgISFpbWFnZVByZXZpZXd9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxQYXBlcmNsaXAgc2l6ZT17MjB9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiU2VuZCBtZXNzYWdlXCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgYnRuIGJ0bi1zbSBzbTpidG4tbWQgYnRuLWNpcmNsZSAke2lzU2VuZGluZ01lc3NhZ2UgPyAnbG9hZGluZyBidG4tZGlzYWJsZWQnIDogJyd9YH1cbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyghdGV4dC50cmltKCkgJiYgIWltYWdlUHJldmlldyAmJiAhc2VsZWN0ZWRGaWxlKSB8fCBpc1NlbmRpbmdNZXNzYWdlfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgeyFpc1NlbmRpbmdNZXNzYWdlICYmIDxTZW5kIHNpemU9ezIyfSAvPn1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9kaXY+XG4gICAgKTtcbn07XG5leHBvcnQgZGVmYXVsdCBNZXNzYWdlSW5wdXQ7XG4iXSwiZmlsZSI6IkU6L0RvX2FuX0xhcF9UcmluaF9tYW5nL05UMTA2Lk5ob203L2Zyb250ZW5kL3NyYy9jb21wb25lbnRzL01lc3NhZ2VJbnB1dC5qc3gifQ==